# https://github.com/coreruleset/coreruleset/blob/v4.0.0/rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example
#
# "...,ctl:ruleRemoveById=942100"
# "...,ctl:ruleRemoveByTag=attack-sqli"
# "...,ctl:ruleRemoveTargetById=942100;ARGS:password"
# "...,ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:password"

# test_cookie_3
SecRule REQUEST_COOKIES_NAMES "@streq username" \
    "id:999001,\
    phase:1,\
    deny,\
    t:none,t:urlDecodeUni,\
    log,\
    msg:'Block use of <username> cookie name',\
    tag:'custom',\
    ver:'CUSTOM/0.0.1',\
    severity:'CRITICAL'"


# test_nosql_1
SecRule REQUEST_FILENAME "@beginsWith /nosql/"
    "id:999002,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=932240,\
    ctl:ruleRemoveById=942100,\
    ctl:ruleRemoveById=942130,\
    ctl:ruleRemoveById=942330,\
    ctl:ruleRemoveById=942390,\
    ctl:ruleRemoveById=942520,\
    ctl:ruleRemoveById=942521,\
    ctl:ruleRemoveById=942511,\
    ctl:ruleRemoveById=942180"


# test_get_params_1
SecRule ARGS:action "@streq netstat" \
    "id:999003,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveByTag=attack-rce,\
    ctl:auditEngine=Off"


# test_file_1
SecRule REQUEST_FILENAME "@rx \/([^\/]+?\.sql|backup\.\w+?|HEAD|settings\.xml|config\.json)$" \
    "id:999004,\
    phase:1,\
    deny,\
    t:none,t:urlDecodeUni,\
    log,\
    msg:'Prevent downloads of database backups',\
    tag:'custom',\
    ver:'CUSTOM/0.0.1',\
    severity:'CRITICAL',\
    status:404"


# test_file_3
SecRule REQUEST_FILENAME "@streq /file/api" \
    "id:999005,\
    phase:1,\
    deny,\
    status:404,\
    msg:'Prevent access to files outsise /home directory',\
    tag:'custom',\
    ver:'CUSTOM/0.0.1',\
    severity:'CRITICAL',\
    chain"
    SecRule ARGS:path "!@beginsWith /home/" \
        "t:none,t:urlDecodeUni"


# test_user_agent_1
SecRule REQUEST_HEADERS:User-Agent "@rx ^Mozilla/\d+.\d+ \(Linux; Android \d+; id\) AppleWebKit/\d+.\d+ \(KHTML, like Gecko\) Chrome/\d+\.\d+\.\d+\.\d+ Mobile Safari/\d+\.\d+$"
    "id:999006,\
    phase:1,\
    pass,\
    nolog,\
    tag:'custom',\
    ver:'CUSTOM/0.0.1',\
    ctl:ruleRemoveByTag=attack-rce"